<!DOCTYPE html>
<html lang="it">
<head>
<script>(function(){var t=localStorage.getItem('vessel-theme');if(t)document.documentElement.setAttribute('data-theme',t);})()</script>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#060a06">
<link rel="icon" type="image/jpeg" href="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCABAAEADASIAAhEBAxEB/8QAGwAAAgMBAQEAAAAAAAAAAAAAAAQDBQYBAgj/xAAzEAACAQMCAwUGBQUAAAAAAAABAgMABBEFIRIxUQYTFEFhIkJxgZGhMjM0YqIkUsHR4f/EABgBAQEBAQEAAAAAAAAAAAAAAAABAwIE/8QAHxEAAgIBBQEBAAAAAAAAAAAAAAECERIDBCExQcHx/9oADAMBAAIRAxEAPwD5foooqHIAEkAAknYAedMizkH5jRxnozbj5DJFTWscihEgXNzMCQc44Ewd8+WwJJ6fGr9ez8EOlie/MMMUhKxz3DlQxHMKu2PoTQqRmWtJMewUk2zhGyfpzper++0TwyQvaSxnvPy2STiSQjnggnBz8xVXcDvo3lK8M8ZxKMYzvjJ9c7H4g9aBoUooooQK6AWIUczsK5U1mvFdwD965+GcmgNDoAifV7xiMmFfYB3GAcDPpsnyzVz2g0+41Se27+QeGjZymWwFTCYUnkvnz3361R9mTEt3LNNJwRzJMr7kAIEBJyN+Zxt51Z6fdxppd1OyeKhZSixNk96SyjG4OPIEnfpWepdpo921cMXGa7+cjGmaSLF57cujW5mWQSNt7JU5AbqMDl0qg1e0MGslXzifijckjdweEnbrlWq0vrqNotOcq9vaTAKsaEjg3wQMY8s/9pfti8Ul74u2ZQomAQDkR3YwR6ZQfWmnfpN0oKlDz9MmOW/Oipr1Al3Mq/hDnHw5ioa0PEFMWP6kHojn+BpemLDe6Vf7wyD4lSB9zQFlp83dTaR3eULSzIXzsckD/VbWyS/vdVk0/TrKGSGBC8jKgGCB7uOZxvjesHbL4my7iIMLlJBJAVO/H5rj1XhI9Vx50/pvajV9O1gXGl3ipcToglWUDhDqMb8W2ee/7qjVm0Z4x47NzeeI0u6nS9igDwWviY3GzBdxupGzZHpnJrBX3FcdmraZlAMGNwv4svjJP2+VM33aHV+1F5Kt5NCZ5UEGY0CIIwcsxxzGw+u1edWuLaLSFs4JJBJ3iIsLAflpxZc48y2dvWolTE55JWUV9+oz1RD/AAWl6nvz/VyAe7hPoAP8VBXRiFdUlWBU4IOQelcooB/DTsZbRlWRx7UedwfQefUYz08q8a1O1/qcs726wSv+NVJxkbEnPLkc0nz50yLyXbIjZh77Rgn786FsLG7ltobuNSVkkQQ8QXZV4sk/b6E1I7eELcTCW6Jyxb2uA+vVvTcD48o/GSDHAkKMPeVN/vnHypckkkkkk7kmgs4SSSSck+dFFFCH/9k=">
<link rel="apple-touch-icon" sizes="192x192" href="data:image/jpeg;base64,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">
<link rel="manifest" href="/manifest.json">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600;700&display=swap">
<title>Vessel — Login</title>
<style>
  :root {
    --bg: #020502; --bg2: #081208; --card: #0a1a0a; --card2: #0f220f;
    --border: #162816; --border2: #1e3a1e;
    --accent: #00ff41; --accent2: #00dd38; --accent3: #00aa2a; --accent-dim: #002a0e;
    --glow-sm: 0 0 4px rgba(0,255,65,0.4);
    --glow-md: 0 0 8px rgba(0,255,65,0.3), 0 0 20px rgba(0,255,65,0.12);
    --red: #ff3333; --muted: #3d6b3d; --text: #c8ffc8; --text2: #7ab87a;
    --amber: #ffb000; --btn-hover: #004422;
    --font: 'JetBrains Mono', 'Fira Code', monospace;
  }
  [data-theme="amber"] {
    --bg: #050300; --bg2: #0f0a04; --card: #1a1008; --card2: #22160a;
    --border: #2e2010; --border2: #3e2e18;
    --accent: #ffb000; --accent2: #dd9800; --accent3: #aa7400; --accent-dim: #2a1a00;
    --glow-sm: 0 0 4px rgba(255,176,0,0.4);
    --glow-md: 0 0 8px rgba(255,176,0,0.3), 0 0 20px rgba(255,176,0,0.12);
    --red: #ff3333; --muted: #6b5530; --text: #ffe0a0; --text2: #b89860;
    --amber: #ff8800; --btn-hover: #442200;
  }
  [data-theme="cyan"] {
    --bg: #000305; --bg2: #040a10; --card: #081420; --card2: #0c1c2a;
    --border: #102838; --border2: #183a4e;
    --accent: #00ffcc; --accent2: #00ddaa; --accent3: #00aa88; --accent-dim: #002a22;
    --glow-sm: 0 0 4px rgba(0,255,204,0.4);
    --glow-md: 0 0 8px rgba(0,255,204,0.3), 0 0 20px rgba(0,255,204,0.12);
    --red: #ff3333; --muted: #305858; --text: #c0f0f0; --text2: #6aa8a8;
    --amber: #44aaff; --btn-hover: #003344;
  }
  [data-theme="red"] {
    --bg: #050000; --bg2: #100404; --card: #1a0808; --card2: #220c0c;
    --border: #2e1414; --border2: #3e1e1e;
    --accent: #ff3333; --accent2: #dd2828; --accent3: #aa1e1e; --accent-dim: #2a0808;
    --glow-sm: 0 0 4px rgba(255,51,51,0.4);
    --glow-md: 0 0 8px rgba(255,51,51,0.3), 0 0 20px rgba(255,51,51,0.12);
    --red: #ff5555; --muted: #6b3d3d; --text: #ffc8c8; --text2: #b87a7a;
    --amber: #ff8844; --btn-hover: #440000;
  }
  [data-theme="sigil"] {
    --bg: #050208; --bg2: #0a0614; --card: #120820; --card2: #180c2a;
    --border: #251440; --border2: #351e58;
    --accent: #b44dff; --accent2: #9b3de0; --accent3: #6a2d9e; --accent-dim: #1a0a2a;
    --glow-sm: 0 0 4px rgba(180,77,255,0.4);
    --glow-md: 0 0 8px rgba(180,77,255,0.3), 0 0 20px rgba(180,77,255,0.12);
    --red: #ff0040; --muted: #5a3878; --text: #e0d0f0; --text2: #9878b8;
    --amber: #e0a0ff; --btn-hover: #2a1048;
  }
  [data-theme="ghost"] {
    --bg: #020202; --bg2: #0a0a0a; --card: #111111; --card2: #1a1a1a;
    --border: #252525; --border2: #333333;
    --accent: #e0e0e0; --accent2: #bbbbbb; --accent3: #888888; --accent-dim: #1a1a1a;
    --glow-sm: 0 0 4px rgba(224,224,224,0.3);
    --glow-md: 0 0 8px rgba(224,224,224,0.2), 0 0 20px rgba(224,224,224,0.08);
    --red: #cc4444; --muted: #555555; --text: #d0d0d0; --text2: #888888;
    --amber: #aa9966; --btn-hover: #2a2a2a;
  }
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    background: var(--bg); color: var(--text); font-family: var(--font);
    height: 100vh; height: 100dvh; display: flex; align-items: center; justify-content: center;
    overflow: hidden; position: fixed; inset: 0;
    background-image: repeating-linear-gradient(0deg, transparent, transparent 2px,
      rgba(0,0,0,0.03) 2px, rgba(0,0,0,0.03) 4px);
  }
  .login-box {
    background: var(--card); border: 1px solid var(--border2); border-radius: 8px;
    padding: 36px 32px 28px; width: min(380px, 90vw); text-align: center;
    box-shadow: 0 0 60px var(--accent-dim);
  }
  .login-icon { display: none; }
  .login-sigil-wrap {
    width: min(280px, 70vw);
    aspect-ratio: 320 / 170;
    margin: 0 auto 14px;
    border-radius: 6px;
    overflow: hidden;
    background: var(--bg);
  }
  .login-sigil-canvas {
    width: 100%; height: 100%; display: block;
  }
  .login-title { font-size: 20px; font-weight: 700; color: var(--accent); letter-spacing: 2px;
    text-shadow: 0 0 10px var(--accent3); margin-bottom: 6px; }
  .login-sub { font-size: 12px; color: var(--muted); margin-bottom: 24px; }
  #pin-input { position: absolute; opacity: 0; pointer-events: none; }
  .pin-display {
    display: flex; gap: 10px; justify-content: center; margin-bottom: 6px;
  }
  .pin-dot {
    width: 16px; height: 16px; border-radius: 50%; border: 2px solid var(--accent3);
    background: transparent; transition: background .15s, box-shadow .15s;
  }
  .pin-dot.filled {
    background: var(--accent); box-shadow: 0 0 8px var(--accent3);
  }
  .pin-counter {
    font-size: 11px; color: var(--muted); margin-bottom: 16px; letter-spacing: 1px;
  }
  .numpad {
    display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;
    width: min(300px, 80vw); margin: 0 auto;
  }
  .numpad-btn {
    font-family: var(--font); font-size: 24px; font-weight: 600;
    padding: 16px 0; border: 1px solid var(--border2); border-radius: 8px;
    background: var(--bg2); color: var(--accent); cursor: pointer;
    transition: all .15s; -webkit-tap-highlight-color: transparent;
    user-select: none; min-height: 58px; touch-action: manipulation;
  }
  .numpad-btn:active { background: var(--accent-dim); border-color: var(--accent3); }
  .numpad-btn.fn { font-size: 14px; color: var(--muted); }
  .numpad-btn.fn:active { color: var(--accent); }
  .numpad-bottom {
    width: min(300px, 80vw); margin: 14px auto 0;
  }
  .numpad-submit {
    font-family: var(--font); font-size: 14px; font-weight: 600; letter-spacing: 2px;
    width: 100%; padding: 16px 0; border: 1px solid var(--accent3); border-radius: 8px;
    background: var(--accent-dim); color: var(--accent); cursor: pointer;
    transition: all .15s; -webkit-tap-highlight-color: transparent;
    user-select: none; text-transform: uppercase; touch-action: manipulation;
  }
  .numpad-submit:active { background: var(--btn-hover); }
  #login-error {
    margin-top: 12px; font-size: 11px; color: var(--red); min-height: 16px;
  }
  @keyframes shake { 0%,100%{transform:translateX(0)} 25%{transform:translateX(-6px)} 75%{transform:translateX(6px)} }
  .shake { animation: shake .3s; }
  /* CRT power-on transition */
  @keyframes crt-on {
    0% { transform: scaleY(0.005) scaleX(0); opacity: 1; filter: brightness(30); }
    20% { transform: scaleY(0.005) scaleX(1); opacity: 1; filter: brightness(30); }
    40% { transform: scaleY(1) scaleX(1); opacity: 1; filter: brightness(2); }
    60% { transform: scaleY(1) scaleX(1); opacity: 1; filter: brightness(1.2); }
    100% { transform: scaleY(1) scaleX(1); opacity: 1; filter: brightness(1); }
  }
  .crt-on {
    animation: crt-on 0.6s cubic-bezier(0.2, 0, 0.1, 1) forwards;
  }
  @keyframes crt-glow {
    0% { box-shadow: 0 0 0px transparent; }
    50% { box-shadow: var(--glow-md), inset 0 0 40px var(--accent-dim); }
    100% { box-shadow: var(--glow-sm); }
  }
  .crt-glow { animation: crt-glow 0.8s ease-out; }
</style>
</head>
<body>
<div class="login-box" id="login-box">
  <div class="login-sigil-wrap">
    <canvas id="login-sigil-canvas" class="login-sigil-canvas"></canvas>
  </div>
  <div class="login-title">VESSEL</div>
  <div class="login-sub" id="login-sub">Inserisci PIN</div>
  <input id="pin-input" type="password" inputmode="none" pattern="[0-9]*"
    maxlength="4" autocomplete="off" readonly tabindex="-1">
  <div class="pin-display" id="pin-display"></div>
  <div class="pin-counter" id="pin-counter">0 / 6</div>
  <div class="numpad">
    <button class="numpad-btn" onclick="numpadPress('1')">1</button>
    <button class="numpad-btn" onclick="numpadPress('2')">2</button>
    <button class="numpad-btn" onclick="numpadPress('3')">3</button>
    <button class="numpad-btn" onclick="numpadPress('4')">4</button>
    <button class="numpad-btn" onclick="numpadPress('5')">5</button>
    <button class="numpad-btn" onclick="numpadPress('6')">6</button>
    <button class="numpad-btn" onclick="numpadPress('7')">7</button>
    <button class="numpad-btn" onclick="numpadPress('8')">8</button>
    <button class="numpad-btn" onclick="numpadPress('9')">9</button>
    <button class="numpad-btn fn" onclick="numpadClear()">C</button>
    <button class="numpad-btn" onclick="numpadPress('0')">0</button>
    <button class="numpad-btn fn" onclick="numpadDel()">DEL</button>
  </div>
  <div class="numpad-bottom">
    <button class="numpad-submit" onclick="doLogin()">SBLOCCA</button>
  </div>
  <div id="login-error"></div>
</div>
<script>
// ── Sigil Engine (cinematic login) ──
const _SC = (function() {
  const cs = getComputedStyle(document.documentElement);
  const v = (p, d) => cs.getPropertyValue(p).trim() || d;
  return {
    hood: v('--accent3', '#00aa2a'), hoodEdge: v('--accent2', '#00dd38'),
    eye: v('--accent', '#00ff41'), glow: v('--accent', '#00ff41'),
    sigil: '#ff0040', bg: v('--bg', '#020502')
  };
})();
function _h2r(h){if(typeof h==='string'&&h.startsWith('rgb')){const m=h.match(/(\d+)/g);return{r:+m[0],g:+m[1],b:+m[2]};}h=h.replace('#','');return{r:parseInt(h.slice(0,2),16),g:parseInt(h.slice(2,4),16),b:parseInt(h.slice(4,6),16)};}
function _lc(c1,c2,t){const a=_h2r(c1),b=_h2r(c2);return`rgb(${a.r+(b.r-a.r)*t|0},${a.g+(b.g-a.g)*t|0},${a.b+(b.b-a.b)*t|0})`;}
function _ra(h,a){const c=_h2r(h);return`rgba(${c.r},${c.g},${c.b},${a})`;}

function _drawLoginHood(ctx,W,H){
  const cx=W/2,r=W*.297,hcy=H*.635,peakY=H*.071,shoulder=W*.328,baseY=H*1.03;
  const ambG=ctx.createRadialGradient(cx,hcy,r*.6,cx,hcy,r*1.6);
  ambG.addColorStop(0,_ra(_SC.hoodEdge,.06));ambG.addColorStop(1,'rgba(0,0,0,0)');
  ctx.fillStyle=ambG;ctx.fillRect(0,0,W,H);
  function hp(){ctx.beginPath();ctx.moveTo(cx-shoulder,baseY);
    ctx.bezierCurveTo(cx-shoulder,hcy+r*.15,cx-r*.85,hcy-r*.2,cx-r*.5,peakY+H*.103);
    ctx.quadraticCurveTo(cx,peakY-H*.024,cx+r*.5,peakY+H*.103);
    ctx.bezierCurveTo(cx+r*.85,hcy-r*.2,cx+shoulder,hcy+r*.15,cx+shoulder,baseY);ctx.closePath();}
  hp();const dk=_lc(_SC.hood,'#000',.45),md=_lc(_SC.hood,'#000',.15);
  const hg=ctx.createLinearGradient(cx-shoulder,0,cx+shoulder,0);
  hg.addColorStop(0,_ra(dk,.3));hg.addColorStop(.12,dk);hg.addColorStop(.28,md);
  hg.addColorStop(.4,_SC.hoodEdge);hg.addColorStop(.5,_lc(_SC.hoodEdge,'#fff',.03));
  hg.addColorStop(.6,_SC.hoodEdge);hg.addColorStop(.72,md);hg.addColorStop(.88,dk);
  hg.addColorStop(1,_ra(dk,.3));ctx.fillStyle=hg;ctx.fill();
  hp();const vg=ctx.createLinearGradient(0,peakY,0,baseY);
  vg.addColorStop(0,'rgba(255,255,255,.03)');vg.addColorStop(.2,'rgba(0,0,0,0)');
  vg.addColorStop(.55,'rgba(0,0,0,.25)');vg.addColorStop(1,'rgba(0,0,0,.65)');
  ctx.fillStyle=vg;ctx.fill();
  hp();const cd=ctx.createRadialGradient(cx,hcy+H*.03,r*.05,cx,hcy+H*.03,r*.95);
  cd.addColorStop(0,'rgba(0,0,0,.85)');cd.addColorStop(.4,'rgba(0,0,0,.6)');
  cd.addColorStop(.7,'rgba(0,0,0,.2)');cd.addColorStop(1,'rgba(0,0,0,0)');
  ctx.fillStyle=cd;ctx.fill();
  const fow=r*.72,oCY=hcy+H*.07;
  const sh=ctx.createRadialGradient(cx,oCY,fow*.15,cx,oCY,fow*1.15);
  sh.addColorStop(0,'rgba(0,0,0,.9)');sh.addColorStop(.45,'rgba(0,0,0,.6)');
  sh.addColorStop(.75,'rgba(0,0,0,.15)');sh.addColorStop(1,'rgba(0,0,0,0)');
  ctx.fillStyle=sh;ctx.beginPath();ctx.ellipse(cx,oCY,fow*1.15,fow*.95,0,0,Math.PI*2);ctx.fill();
}

function _drawLoginEye(ctx,ex,ey,sz,col,gCol,gR,int){
  int=int??1;const gc=_h2r(gCol);
  const g1=ctx.createRadialGradient(ex,ey,0,ex,ey,gR*int);
  g1.addColorStop(0,`rgba(${gc.r},${gc.g},${gc.b},${.5*int})`);
  g1.addColorStop(.3,`rgba(${gc.r},${gc.g},${gc.b},${.25*int})`);
  g1.addColorStop(.6,`rgba(${gc.r},${gc.g},${gc.b},${.08*int})`);
  g1.addColorStop(1,'rgba(0,0,0,0)');ctx.fillStyle=g1;
  ctx.beginPath();ctx.arc(ex,ey,gR*int,0,Math.PI*2);ctx.fill();
  ctx.fillStyle=col;ctx.beginPath();ctx.moveTo(ex-sz,ey);
  ctx.bezierCurveTo(ex-sz*.5,ey-sz*.7,ex+sz*.5,ey-sz*.7,ex+sz,ey);
  ctx.bezierCurveTo(ex+sz*.5,ey+sz*.7,ex-sz*.5,ey+sz*.7,ex-sz,ey);ctx.closePath();ctx.fill();
  const cr=ctx.createRadialGradient(ex,ey,0,ex,ey,sz*.5);
  cr.addColorStop(0,'rgba(255,255,255,.9)');cr.addColorStop(.4,col);cr.addColorStop(1,_ra(col,.5));
  ctx.fillStyle=cr;ctx.beginPath();ctx.ellipse(ex,ey,sz*.55,sz*.38,0,0,Math.PI*2);ctx.fill();
  ctx.fillStyle='#000';ctx.beginPath();ctx.arc(ex,ey,sz*.18,0,Math.PI*2);ctx.fill();
}

function _drawLoginHappy(ctx,ex,ey,sz,col,gCol,gR){
  const gc=_h2r(gCol);const g1=ctx.createRadialGradient(ex,ey,0,ex,ey,gR*.7);
  g1.addColorStop(0,`rgba(${gc.r},${gc.g},${gc.b},.25)`);g1.addColorStop(1,'rgba(0,0,0,0)');
  ctx.fillStyle=g1;ctx.beginPath();ctx.arc(ex,ey,gR*.7,0,Math.PI*2);ctx.fill();
  ctx.strokeStyle=col;ctx.lineWidth=3.5;ctx.lineCap='round';ctx.beginPath();
  ctx.arc(ex,ey+sz*.3,sz*.8,Math.PI*1.15,Math.PI*1.85);ctx.stroke();
}

function _drawLoginEyeClosing(ctx,ex,ey,sz,col,gCol,gR,closeT){
  const gc=_h2r(gCol);
  const alpha=closeT<.8?1:(1-(closeT-.8)/.2);
  const glowInt=Math.max(0,1-closeT*1.2);
  if(glowInt>0){
    const g1=ctx.createRadialGradient(ex,ey,0,ex,ey,gR*glowInt);
    g1.addColorStop(0,`rgba(${gc.r},${gc.g},${gc.b},${.3*glowInt})`);
    g1.addColorStop(1,'rgba(0,0,0,0)');
    ctx.fillStyle=g1;ctx.beginPath();ctx.arc(ex,ey,gR*glowInt,0,Math.PI*2);ctx.fill();
  }
  ctx.globalAlpha=alpha;
  if(closeT<.5){
    const hFactor=1-closeT*2;
    ctx.fillStyle=col;ctx.beginPath();ctx.moveTo(ex-sz,ey);
    ctx.bezierCurveTo(ex-sz*.5,ey-sz*.7*hFactor,ex+sz*.5,ey-sz*.7*hFactor,ex+sz,ey);
    ctx.bezierCurveTo(ex+sz*.5,ey+sz*.7*hFactor,ex-sz*.5,ey+sz*.7*hFactor,ex-sz,ey);
    ctx.closePath();ctx.fill();
  } else {
    ctx.strokeStyle=col;ctx.lineWidth=2.5;ctx.lineCap='round';
    ctx.beginPath();ctx.moveTo(ex-sz,ey);ctx.lineTo(ex+sz,ey);ctx.stroke();
  }
  ctx.globalAlpha=1;
}

function _drawLoginBrainGlyph(ctx,gx,gy,col,scale,rotation,glowInt){
  ctx.save();ctx.translate(gx,gy);ctx.rotate(rotation);ctx.scale(scale,scale);
  const gc=_h2r(col);
  if(glowInt>0){
    const g1=ctx.createRadialGradient(0,0,0,0,0,22);
    g1.addColorStop(0,`rgba(${gc.r},${gc.g},${gc.b},${.35*glowInt})`);
    g1.addColorStop(.5,`rgba(${gc.r},${gc.g},${gc.b},${.12*glowInt})`);
    g1.addColorStop(1,'rgba(0,0,0,0)');
    ctx.fillStyle=g1;ctx.beginPath();ctx.arc(0,0,22,0,Math.PI*2);ctx.fill();
  }
  ctx.strokeStyle=col;ctx.fillStyle=col;ctx.lineCap='round';
  ctx.lineWidth=2;ctx.beginPath();ctx.moveTo(0,-9);ctx.lineTo(0,9);ctx.stroke();
  ctx.beginPath();ctx.moveTo(-9,0);ctx.lineTo(9,0);ctx.stroke();
  ctx.lineWidth=1;
  ctx.beginPath();ctx.moveTo(-6,-6);ctx.lineTo(6,6);ctx.stroke();
  ctx.beginPath();ctx.moveTo(-6,6);ctx.lineTo(6,-6);ctx.stroke();
  ctx.lineWidth=1.5;ctx.beginPath();ctx.arc(0,0,4,0,Math.PI*2);ctx.stroke();
  const dp=11;const dr=1.8;
  ctx.beginPath();ctx.arc(0,-dp,dr,0,Math.PI*2);ctx.fill();
  ctx.beginPath();ctx.arc(0,dp,dr,0,Math.PI*2);ctx.fill();
  ctx.beginPath();ctx.arc(-dp,0,dr,0,Math.PI*2);ctx.fill();
  ctx.beginPath();ctx.arc(dp,0,dr,0,Math.PI*2);ctx.fill();
  ctx.restore();
}

// ── State machine ──
const DIGIT_POS={'1':{x:-1,y:-1},'2':{x:0,y:-1},'3':{x:1,y:-1},'4':{x:-1,y:0},'5':{x:0,y:0},'6':{x:1,y:0},'7':{x:-1,y:1},'8':{x:0,y:1},'9':{x:1,y:1},'0':{x:0,y:1.5}};
let _loginState='ALERT', _loginStart=Date.now(), _loginAnim=null;
let _glanceTargetX=0, _glanceTargetY=0, _glanceTime=0;
let _firstDigitPressed=false;

function _loginLoop(){
  const c=document.getElementById('login-sigil-canvas');
  if(!c)return;
  const ctx=c.getContext('2d');
  const dpr=window.devicePixelRatio||1;
  const dW=c.clientWidth,dH=c.clientHeight;
  if(c.width!==dW*dpr||c.height!==dH*dpr){c.width=dW*dpr;c.height=dH*dpr;}
  const W=dW,H=dH,now=Date.now()-_loginStart;
  ctx.save();ctx.scale(dpr,dpr);
  ctx.fillStyle=_SC.bg;ctx.fillRect(0,0,W,H);

  const sx=W/320,sy=H/170,s=Math.min(sx,sy),cx=W/2;
  const eyY=82*sy,ed=44*s,es=18*s,gr=28*s,lx=cx-ed,rx=cx+ed;

  // Glance offset (decays over 300ms)
  const glElapsed=Date.now()-_glanceTime;
  const glDecay=Math.max(0,1-glElapsed/300);
  const glX=_glanceTargetX*glDecay*s;
  const glY=_glanceTargetY*glDecay*s;

  // Scanlines
  ctx.fillStyle='rgba(0,0,0,.04)';
  for(let y=0;y<H;y+=2)ctx.fillRect(0,y,W,1);

  if(_loginState==='ALERT'){
    // Eyes wake up and scan around — someone knocked at the gate
    const ramp=Math.min(1,now/200);
    const intensity=.7*ramp;
    const scanDx=10*Math.sin(now/400*Math.PI)*s*ramp;
    const scanDy=3*Math.cos(now/600*Math.PI)*s*ramp;
    const ec=_lc('#001a08',_SC.eye,intensity);
    _drawLoginEye(ctx,lx+scanDx,eyY+scanDy,es*1.1,ec,_SC.glow,gr*.7,intensity);
    _drawLoginEye(ctx,rx+scanDx,eyY+scanDy,es*1.1,ec,_SC.glow,gr*.7,intensity);
    // Auto-transition to WATCHING after 2s
    if(now>2000){_loginState='WATCHING';_loginStart=Date.now();}
  } else if(_loginState==='WATCHING'){
    // Dim eyes in the dark, breathing slowly
    const breath=.3+.15*Math.sin(now/5000*Math.PI*2);
    const ec=_lc('#001a08',_SC.eye,breath);
    const dx=2*Math.sin(now/6000)+glX;
    const dy=1.5*Math.cos(now/8000)+glY;
    _drawLoginEye(ctx,lx+dx,eyY+dy,es*.85,ec,_SC.glow,gr*.5,breath*.6);
    _drawLoginEye(ctx,rx+dx,eyY+dy,es*.85,ec,_SC.glow,gr*.5,breath*.6);
  } else if(_loginState==='IDLE'){
    // Eyes in the dark — no hood, just brighter eyes watching
    const breath=.8+.2*Math.sin(now/4000*Math.PI*2);
    const ec=_lc('#004415',_SC.eye,breath);
    const dx=3*Math.sin(now/5000)+glX;
    const dy=2*Math.cos(now/7000)+glY;
    _drawLoginEye(ctx,lx+dx,eyY+dy,es,ec,_SC.glow,gr,breath);
    _drawLoginEye(ctx,rx+dx,eyY+dy,es,ec,_SC.glow,gr,breath);
  } else if(_loginState==='REJECT'){
    // Eyes shift sideways in disappointment
    const t=now;
    let shiftX=0;
    if(t<200) shiftX=8*s*(t/200);
    else if(t<400) shiftX=8*s*(1-(t-200)/200)*-0.6;
    else shiftX=0;
    const dimFade=t>800?Math.max(.4,1-(t-800)/400):1;
    const ec=_lc('#004415',_SC.eye,dimFade*.7);
    _drawLoginEye(ctx,lx+shiftX,eyY,es,ec,_SC.glow,gr,dimFade*.7);
    _drawLoginEye(ctx,rx+shiftX,eyY,es,ec,_SC.glow,gr,dimFade*.7);
  } else if(_loginState==='UNLOCK'){
    const t=now;
    if(t<150){
      // Brief happy flash — eyes smile
      _drawLoginHappy(ctx,lx,eyY,es,_SC.eye,_SC.glow,gr);
      _drawLoginHappy(ctx,rx,eyY,es,_SC.eye,_SC.glow,gr);
    } else if(t<500){
      // Eyes closing
      const closeT=(t-150)/350;
      _drawLoginEyeClosing(ctx,lx,eyY,es,_SC.eye,_SC.glow,gr,closeT);
      _drawLoginEyeClosing(ctx,rx,eyY,es,_SC.eye,_SC.glow,gr,closeT);
    } else if(t<900){
      // Dark pause
    } else if(t<2500){
      // Brain glyph fade-in + pulse
      const glyphY=43*sy;
      const fadeIn=Math.min(1,(t-900)/800);
      const pulse=t>1800?1+.12*Math.sin((t-1800)/120*Math.PI*2):1;
      const rot=(t-900)/8000*Math.PI*2;
      _drawLoginBrainGlyph(ctx,cx,glyphY,_SC.sigil,pulse*fadeIn,rot,fadeIn);
    } else if(t<2700){
      // Flash
      const glyphY=43*sy;
      const flashT=(t-2500)/200;
      _drawLoginBrainGlyph(ctx,cx,glyphY,'#ffffff',1.2,0,1);
      ctx.fillStyle=`rgba(255,255,255,${.3*(1-flashT)})`;
      ctx.fillRect(0,0,W,H);
    }
    // After 2700ms the login-box fades via JS in doLogin
  }

  ctx.restore();
  _loginAnim=requestAnimationFrame(_loginLoop);
}
_loginLoop();

const MAX_PIN = 4;
let pinValue = '';

function updatePinDisplay() {
  const display = document.getElementById('pin-display');
  const counter = document.getElementById('pin-counter');
  display.innerHTML = '';
  for (let i = 0; i < MAX_PIN; i++) {
    const dot = document.createElement('div');
    dot.className = 'pin-dot' + (i < pinValue.length ? ' filled' : '');
    display.appendChild(dot);
  }
  counter.textContent = '';
  document.getElementById('pin-input').value = pinValue;
}

function numpadPress(n) {
  if (pinValue.length >= MAX_PIN) return;
  // Eye glance toward pressed digit
  const pos = DIGIT_POS[String(n)];
  if(pos){ _glanceTargetX=pos.x*4; _glanceTargetY=pos.y*2.5; _glanceTime=Date.now(); }
  // First digit: transition to IDLE (eyes become brighter)
  if(!_firstDigitPressed){
    _firstDigitPressed=true;
    if(_loginState==='WATCHING'||_loginState==='ALERT'){_loginState='IDLE';_loginStart=Date.now();}
  }
  pinValue += n;
  updatePinDisplay();
  if (pinValue.length === MAX_PIN) setTimeout(doLogin, 150);
}

function numpadDel() {
  if (pinValue.length === 0) return;
  pinValue = pinValue.slice(0, -1);
  updatePinDisplay();
}

function numpadClear() {
  pinValue = '';
  updatePinDisplay();
}

updatePinDisplay();

(async function() {
  const r = await fetch('/auth/check');
  const d = await r.json();
  if (d.authenticated) { window.location.href = '/'; return; }
  if (d.setup) {
    document.getElementById('login-sub').textContent = 'Imposta il PIN (4 cifre)';
  }
})();

async function doLogin() {
  const pin = pinValue.trim();
  if (!pin) return;
  const errEl = document.getElementById('login-error');
  errEl.textContent = '';
  try {
    const r = await fetch('/auth/login', {
      method: 'POST', headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({ pin })
    });
    const d = await r.json();
    if (d.ok) {
      // UNLOCK cinematic sequence — brain glyph activation
      _loginState = 'UNLOCK'; _loginStart = Date.now();
      // Prefetch dashboard while animation plays (~3s of dead time)
      const pfLink = document.createElement('link');
      pfLink.rel = 'prefetch'; pfLink.href = '/';
      document.head.appendChild(pfLink);
      setTimeout(() => {
        const box = document.getElementById('login-box');
        box.style.opacity = '0';
        box.style.transition = 'opacity 0.4s';
        document.body.classList.add('crt-glow');
        setTimeout(() => {
          document.body.style.background = getComputedStyle(document.documentElement).getPropertyValue('--bg').trim() || '#020502';
          document.body.classList.add('crt-on');
          setTimeout(() => { window.location.href = '/'; }, 700);
        }, 400);
      }, 2700);
      return;
    } else {
      _loginState = 'REJECT'; _loginStart = Date.now();
      errEl.textContent = d.error || 'PIN errato';
      document.getElementById('login-box').classList.add('shake');
      setTimeout(() => {
        document.getElementById('login-box').classList.remove('shake');
        // Return to WATCHING or IDLE based on hood state
        _loginState = _firstDigitPressed ? 'IDLE' : 'WATCHING';
        _loginStart = Date.now();
      }, 1500);
      pinValue = '';
      updatePinDisplay();
    }
  } catch(e) {
    errEl.textContent = 'Errore di connessione';
  }
}

document.addEventListener('keydown', e => {
  if (e.key >= '0' && e.key <= '9') numpadPress(e.key);
  else if (e.key === 'Backspace') numpadDel();
  else if (e.key === 'Escape') numpadClear();
  else if (e.key === 'Enter') doLogin();
});

// Warm-up server on page load (primes backend processes)
fetch('/api/health').catch(()=>{});
</script>
</body>
</html>